generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlserver"
  url      = env("DATABASE_URL")
}

model User {
  userId            String   @unique
  email             String   @unique
  password          String
  refreshToken      String?
  createdAt         DateTime @default(now())
  updatedAt         DateTime

  //REFERANS VERDİKLERİ
  oldSessions       OldSession[]
  liveSessions      LiveSession?
  books             Book[]
  films             Film[]
  deckCategories    FlashcardCategory[]
  words             Word[]
  sessionSentences  SessionSentence[]
  SessionWords      SessionWord[]
}

model Language {
  id                Int    @id @default(autoincrement())
  language          String @unique
  picturePath       String

  //REFEREANS VERDİKLERİ
  books                 Book[]
  films                 Film[]
  words                 Word[]
  oldSessions           OldSession[]
  flashcardCategories   FlashcardCategory[]

  //BOTH
  practices         Practice[] @relation("LanguagePractices")
}

model Practice {
  id                Int @id @default(autoincrement())
  practice          String

  //REFERANS VERDİKLERİ
  oldSessions       OldSession[]

  //BOTH
  languages         Language[]  @relation("LanguagePractices")
}

model Book {
  id                Int @id @default(autoincrement())
  userId            String
  languageId        Int
  bookName          String
  imagePath         String
  sourcePath        String
  
  //REFERANS ALDIKLARI
  user User @relation(fields: [userId], references: [userId])
  language Language @relation(fields: [languageId], references: [id])
}

model Film {
  id                Int @id @default(autoincrement())
  userId            String
  languageId        Int
  filmName          String @unique
  imagePath         String @unique
  sourcePath        String

  //REFERANS ALDIKLARI
  user User @relation(fields: [userId], references: [userId])
  language Language @relation(fields: [languageId], references: [id])
}

model FlashcardCategory {
  id                Int @id @default(autoincrement())
  userId            String
  languageId        Int
  categoryName      String @unique

  //REFERANS ALDIKLARI
  user User @relation(fields: [userId], references: [userId])
  language Language @relation(fields: [languageId], references: [id])
}

model Word {
  id                Int @id @default(autoincrement())
  userId            String
  languageId        Int
  wordToLearn       String
  translatedWord    String

  //REFERANS ALDIKLARI
  user User @relation(fields: [userId], references: [userId])
  language Language @relation(fields: [languageId], references:[id])
}

model OldSession {
  id                Int @id @default(autoincrement())
  oldSessionId      String @unique
  userId            String
  languageId        Int
  practiceId        Int
  createdOn         DateTime @default(now())
  imagePath         String
  rate              Decimal

  //REFERANS VERDİKLERİ
  sessionSentences  SessionSentence[]
  sessionWord       SessionWord[]

  //REFERANS ALDIKLARI
  user User @relation(fields: [userId], references: [userId])
  language Language @relation(fields: [languageId], references: [id], onUpdate: NoAction, onDelete: NoAction)
  practice Practice @relation(fields: [practiceId], references: [id], onUpdate: NoAction, onDelete: NoAction)
}

model LiveSession {
  id                Int @id @default(autoincrement())
  liveSessionId     String @unique
  userId            String @unique

  //REFERANS ALDIKLARI
  user User @relation(fields: [userId], references: [userId])
}

model SessionSentence {
  id                Int @id @default(autoincrement())
  userId            String
  oldSessionId      String
  original          String
  own               String
  translate         String
  similarity        Decimal

  //REFERANS ALDIKLARI
  user User @relation(fields: [userId], references: [userId], onUpdate: NoAction, onDelete: NoAction)
  oldSession OldSession @relation(fields: [oldSessionId], references:[oldSessionId])
}

model SessionWord {
  id                Int @id @default(autoincrement())
  userId            String
  oldSessionId      String
  word              String
  answer            String
  status            Boolean

  //REFERANS ALDIKLARI
  user User @relation(fields: [userId], references: [userId], onUpdate: NoAction, onDelete: NoAction)
  oldSession OldSession @relation(fields: [oldSessionId], references:[oldSessionId])
}